# 법인카드 지출 내역 검증 시스템

법인카드 지출 내역을 검증하는 파이썬 시스템입니다.

## 기능

### 1. 텍스트 파일을 엑셀로 변환 (`make_xlsx.py`)
- `target.txt` 파일을 읽어서 `target.xlsx`로 변환
- 탭으로 구분된 텍스트 데이터를 엑셀 형식으로 변환

### 2. 법인카드 지출 내역 검증 (`card_validation.py`)
다음 규칙들을 검증합니다:

1. **지출용도가 점심/저녁인 경우 내용 형식 검증**
   - 내용에 "점심" 또는 "저녁"이 포함되어야 함
   - 내용에 사원코드(이름)가 포함되어야 함
   - 예상 형식: "점심, {사원명}" 또는 "저녁, {사원명}"

2. **부가세 검증**
   - 부가세가 0원이 아니어야 함

3. **같은 날짜에 같은 지출용도 그룹화**
   - 같은 거래일자에 같은 지출용도(점심/저녁)가 존재하면 모아서 표시

## 사용법

### 1. 텍스트 파일을 엑셀로 변환
```bash
python make_xlsx.py convert
```

### 2. 법인카드 지출 내역 검증
```bash
python card_validation.py
```

## 파일 구조

```
amaranth-card-validation/
├── target.txt          # 원본 텍스트 데이터
├── target.xlsx         # 변환된 엑셀 파일
├── make_xlsx.py        # 텍스트를 엑셀로 변환하는 스크립트
├── card_validation.py  # 검증 스크립트
└── README.md          # 이 파일
```

## 검증 결과 예시

```
🔍 법인카드 지출 내역 검증을 시작합니다...

📋 규칙 1: 지출용도가 점심/저녁인 경우 내용 형식 검증
📋 규칙 2: 부가세 0원 검증
📋 규칙 3: 같은 날짜에 같은 지출용도 그룹화

📅 같은 날짜에 같은 지출용도 그룹:

🔸 2025.07.09 - 법인카드_식대(점심) (6건):
  - 순번 10: 점심, 오혁상 (사원: 오혁상, 금액: 13,000원)
  - 순번 33: 점심, 정헌진 (사원: 정헌진, 금액: 13,000원)
  - 순번 34: 점심, 권희성 (퇴사자) (사원: 백승한, 금액: 13,000원)
  - 순번 35: 점심, 백승한 (사원: 백승한, 금액: 13,000원)
  - 순번 36: 점심, 조기현 (사원: 조기현, 금액: 13,000원)
  - 순번 39: 점심, 권현성 (사원: 권현성, 금액: 12,600원)

==================================================
📊 검증 결과 요약
==================================================

❌ 오류 (2건):
  - 35행: 내용에 사원코드 '백승한'이 포함되지 않음
    내용: 점심, 권희성 (퇴사자)
  - 41행: 내용에 '저녁'이 포함되지 않음
    내용: 점심, 권현성

⚠️  경고 (2건):
  - 35행: 내용 형식이 예상과 다름 (예상: '점심, 백승한')
    내용: 점심, 권희성 (퇴사자)
  - 41행: 내용 형식이 예상과 다름 (예상: '저녁, 권현성')
    내용: 점심, 권현성

📈 통계:
  - 전체 행 수: 40
  - 오류: 2건
  - 경고: 2건
  - 정상: 38건
```

## 필요한 패키지

```bash
pip install pandas openpyxl
```

## 데이터 형식

입력 데이터는 다음과 같은 형식이어야 합니다:

| 순번 | 거래일자 | 지출용도 | 내용 | 거래처 | 공급가액 | 부가세 | 합계 | 증빙 | 프로젝트 | 사원코드 |
|------|----------|----------|------|--------|----------|--------|------|------|----------|----------|
| 1 | 2025.08.02 | 법인카드_식대(저녁) | 저녁, 정헌진 | 지에스(GS)25 브라이튼 여의도1호 | 11,772 | 1,178 | 12,950 | 신용카드매출전표(법인) | 공통(CMP모니터링팀) | 정헌진 |

## 주의사항

1. **내용 형식**: 점심/저녁 지출의 경우 "점심, {사원명}" 또는 "저녁, {사원명}" 형식으로 작성
2. **사원코드 일치**: 내용의 사원명이 사원코드와 일치해야 함
3. **부가세**: 0원이 아니어야 함
4. **파일 인코딩**: UTF-8 인코딩 사용 권장 